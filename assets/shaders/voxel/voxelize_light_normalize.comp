#version 430
layout(local_size_x = 8, local_size_y = 8, local_size_z = 8) in;

layout(location = 0,rgba32f) restrict uniform image3D lightVoxel;

void main() {
    ivec3 pCoord = ivec3(gl_GlobalInvocationID.xyz);
    vec4 stored = imageLoad(lightVoxel, pCoord);
    if (stored.a == 0.0) {
        return;
    }
    imageStore(lightVoxel, pCoord, vec4(stored.rgb / stored.a, 1.0));
}
